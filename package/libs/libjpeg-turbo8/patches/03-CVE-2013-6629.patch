Description: fix information disclosure via uninitialized memory in
 the get_sos function
Origin: vendor, http://git.chromium.org/gitweb/?p=chromium/deps/libjpeg_turbo.git;a=commit;h=2285c50bcd51dd999d80b99b30ce9aef9fb80833
Bug-Ubuntu: https://bugs.launchpad.net/ubuntu/+source/libjpeg-turbo/+bug/1252912
Bug-Debian: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=729873

Index: libjpeg-turbo-1.3.0/jdmarker.c
===================================================================
--- libjpeg-turbo-1.3.0.orig/jdmarker.c	2013-11-22 09:57:00.959257674 -0500
+++ libjpeg-turbo-1.3.0/jdmarker.c	2013-11-22 09:57:00.955257674 -0500
@@ -348,6 +348,12 @@
     
     TRACEMS3(cinfo, 1, JTRC_SOS_COMPONENT, cc,
 	     compptr->dc_tbl_no, compptr->ac_tbl_no);
+
+    /* This CSi (cc) should differ from the previous CSi */
+    for (ci = 0; ci < i; ci++) {
+      if (cinfo->cur_comp_info[ci] == compptr)
+        ERREXIT1(cinfo, JERR_BAD_COMPONENT_ID, cc);
+    }
   }
 
   /* Collect the additional scan parameters Ss, Se, Ah/Al. */
